# PR Reviewer Assignment Service

Сервис для автоматического назначения ревьюверов на Pull Request'ы.

## Запуск

```bash
docker-compose up
```

Сервис будет доступен на порту 8080.

## Нагрузочное тестирование

Для нагрузочного тестирования используется [k6]. Тесты покрывают все эндпоинты API и проверяют соответствие SLI требованиям.

### Параметры тестов

| Тест | Нагрузка (RPS) | Длительность | Макс. VUs | Пороги |
|------|----------------|--------------|-----------|--------|
| **Low** | 5 | 1 минута | 5 | p(95) < 300ms, checks > 99%, errors < 0.1% |
| **Medium** | 20-50 | 1 минута | 50 | p(95) < 500ms, checks > 98%, errors < 1% |
| **High** | 50-200 | 1 минута | 200 | p(95) < 1000ms, checks > 95%, errors < 5% |
| **Stress** | 100-500 | 1 минута | 500 | p(95) < 2000ms, checks > 90%, errors < 10% |

### Результаты тестирования

| Тест | Статус | p(95) latency | Checks rate | Errors rate | HTTP requests | RPS |
|------|--------|---------------|-------------|-------------|---------------|-----|
| **Low** | ✅ **PASSED** | 5.13ms | 100.00% | 0.00% | 752 | 12.3 |
| **Medium** | ✅ **PASSED** | 8.85ms | 100.00% | 0.00% | 13,080 | 215.1 |
| **High** (run 1) | ❌ **FAILED** | 200.26ms | 93.60% | 6.39% | 89,624 | 1,468.3 |
| **High** (run 2) | ✅ **PASSED** | 232.92ms | 95.43% | 4.56% | 74,224 | 1,216.9 |
| **Stress** | ❌ **FAILED** | 509.58ms | 70.54% | 29.45% | 86,472 | 1,390.0 |

### Выводы

- ✅ **SLI требования выполнены**: при нагрузке 5 RPS сервис показывает p(95) = 5.13ms и 100% успешность запросов
- ✅ **Стабильная работа до 50 RPS**: все пороги пройдены, средняя задержка < 10ms
- ⚠️ **При нагрузке 200 RPS**: наблюдается нестабильность, часть запросов может не проходить проверки
- ❌ **При нагрузке 500 RPS**: сервис не выдерживает экстремальную нагрузку, требуется оптимизация

**Примечание**: Высокий процент `http_req_failed` (16-55%) объясняется тем, что k6 считает 4xx/5xx ошибками, но для данного API статусы 400, 404, 409 являются валидными ответами в определенных сценариях. Основным индикатором успешности служит метрика `checks`, которая явно проверяет ожидаемые статус-коды.

### Запуск тестов

```bash
# Low load
k6 run load_test/load_test_low.js

# Medium load
k6 run load_test/load_test_medium.js

# High load
k6 run load_test/load_test_high.js

# Stress test
k6 run load_test/load_test_stress.js
```

