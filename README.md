# PR Reviewer 

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤ –Ω–∞ Pull Request'—ã —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Å–ª–æ–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   HTTP Handler  ‚îÇ  ‚Üê –°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (HTTP API)
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    Service      ‚îÇ  ‚Üê –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   Repository    ‚îÇ  ‚Üê –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   PostgreSQL    ‚îÇ  ‚Üê –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```


## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Go** 1.25.4 –∏–ª–∏ –≤—ã—à–µ
- **Docker** –∏ **Docker Compose** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **PostgreSQL** 17.7 (–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Docker)
- **k6** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/bagdasarian/avito-pr-reviewer.git
cd avito-pr-reviewer
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å—Ç–µ–∫:

```bash
docker-compose up
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞–ø—É—Å—Ç–∏—Ç PostgreSQL –Ω–∞ –ø–æ—Ä—Ç—É 5433
- –ü—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç—É 8080

–ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ `docker-compose.yml`:
- `POSTGRES_USER=avito`
- `POSTGRES_PASSWORD=avito`
- `POSTGRES_DB=pr_reviewer`
- `DB_HOST=postgres`
- `DB_PORT=5432`
- `DB_SSLMODE=disable`

–ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —ç—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–µ–∫—Ç —Å—Ä–∞–∑—É –∑–∞–ø—É—Å–∫–∞–ª—Å—è –∏–∑ "–∫–æ—Ä–æ–±–∫–∏" –±–µ–∑ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

```env
POSTGRES_USER=your_user
POSTGRES_PASSWORD=your_password
POSTGRES_DB=your_db_name
```

Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env` —Ñ–∞–π–ª–∞.


### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
docker-compose down
```

## üìù Makefile –∫–æ–º–∞–Ω–¥—ã

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç Makefile —Å —É–¥–æ–±–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏:

```bash
make help              # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
make build             # –°–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
make run               # –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ
make test              # –ó–∞–ø—É—Å—Ç–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
make test-integration  # –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
make test-coverage     # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make fmt               # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make docker-up         # –ó–∞–ø—É—Å—Ç–∏—Ç—å docker-compose
make docker-down       # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker-compose
make load-test-low     # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (low)
make load-test-medium  # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (medium)
make load-test-high    # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (high)
make load-test-stress  # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (stress)
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

API —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

### –ö–æ–º–∞–Ω–¥—ã (Teams)

- `POST /team/add` ‚Äî –°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
- `GET /team/get?team_name={name}` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–∞–Ω–¥—É —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Users)

- `POST /users/setIsActive` ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /users/getReview?user_id={id}` ‚Äî –ü–æ–ª—É—á–∏—Ç—å PR'—ã, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω —Ä–µ–≤—å—é–≤–µ—Ä–æ–º

### Pull Requests

- `POST /pullRequest/create` ‚Äî –°–æ–∑–¥–∞—Ç—å PR –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤
- `POST /pullRequest/merge` ‚Äî –ü–æ–º–µ—Ç–∏—Ç—å PR –∫–∞–∫ MERGED (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
- `POST /pullRequest/reassign` ‚Äî –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–µ–≤—å—é–≤–µ—Ä–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- `GET /stats` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–µ–≤—å—é–≤–µ—Ä–∞–º –∏ —Å—Ç–∞—Ç—É—Å–∞–º PR


### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
curl -X POST http://localhost:8080/team/add \
  -H "Content-Type: application/json" \
  -d '{
    "team_name": "backend",
    "members": [
      {"user_id": "u1", "username": "Alice", "is_active": true},
      {"user_id": "u2", "username": "Bob", "is_active": true}
    ]
  }'
```

–°–æ–∑–¥–∞–Ω–∏–µ PR:
```bash
curl -X POST http://localhost:8080/pullRequest/create \
  -H "Content-Type: application/json" \
  -d '{
    "pull_request_id": "pr-1001",
    "pull_request_name": "Add search feature",
    "author_id": "u1"
  }'
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏ —Ç–∏–ø–∞ —Ç–µ—Å—Ç–æ–≤:

### 1. Unit-—Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–∫–æ–≤:

```bash
make test
# –∏–ª–∏
go test ./...
```

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: —Ç–µ—Å—Ç—ã —Å `go-sqlmock` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
- –°–µ—Ä–≤–∏—Å—ã: —Ç–µ—Å—Ç—ã —Å –º–æ–∫–∞–º–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏–∑ `internal/mocks/`

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π PostgreSQL —á–µ—Ä–µ–∑ `testcontainers-go`:

```bash
make test-integration
# –∏–ª–∏
go test -tags=integration -v ./test/integration/...
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- –ò–∑–æ–ª—è—Ü–∏—è: –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å—Ç—É—é –ë–î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- –°–æ–∑–¥–∞–Ω–∏–µ PR —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤
- –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤
- Merge PR –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å merge
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### 3. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º k6:

```bash
make load-test-low      # 5 RPS, 1 –º–∏–Ω—É—Ç–∞
make load-test-medium   # 20-50 RPS, 1 –º–∏–Ω—É—Ç–∞
make load-test-high     # 50-200 RPS, 1 –º–∏–Ω—É—Ç–∞
make load-test-stress   # 100-500 RPS, 1 –º–∏–Ω—É—Ç–∞
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

| –¢–µ—Å—Ç | –°—Ç–∞—Ç—É—Å | p(95) latency | Checks rate | Errors rate | RPS |
|------|--------|--------------|-------------|-------------|-----|
| **Low** | ‚úÖ PASSED | 5.13ms | 100.00% | 0.00% | 12.3 |
| **Medium** | ‚úÖ PASSED | 8.85ms | 100.00% | 0.00% | 215.1 |
| **High** | ‚úÖ PASSED | 232.92ms | 95.43% | 4.56% | 1,216.9 |
| **Stress** | ‚ùå FAILED | 509.58ms | 70.54% | 29.45% | 1,390.0 |

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /stats`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–µ–≤—å—é–≤–µ—Ä–∞–º (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º PR (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PR –≤ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ç—É—Å–µ)

### ‚úÖ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º k6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:
- **RPS:** 5 (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
- **SLI –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞:** p(95) < 300ms (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è low/medium –Ω–∞–≥—Ä—É–∑–æ–∫)
- **SLI —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏:** 99.9% (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è low/medium –Ω–∞–≥—Ä—É–∑–æ–∫)

### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `testcontainers-go`:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ PostgreSQL –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –ë–î
- –ü–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–≤–µ—Ä–∞ –Ω–∞ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–≤—å—é–≤–µ—Ä–∞ –Ω–∞ —Ç–æ–≥–æ, –∫—Ç–æ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ PR, –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `duplicate key value violates unique constraint`.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–µ–≤—å—é–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏–µ–π. –ï—Å–ª–∏ –Ω–æ–≤—ã–π —Ä–µ–≤—å—é–≤–µ—Ä —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è DELETE —Å—Ç–∞—Ä–æ–≥–æ —Ä–µ–≤—å—é–≤–µ—Ä–∞ –≤–º–µ—Å—Ç–æ UPDATE.

### 2. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å merge

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ merge?

**–†–µ—à–µ–Ω–∏–µ:** –û–ø–µ—Ä–∞—Ü–∏—è merge –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å PR. –ï—Å–ª–∏ PR —É–∂–µ –≤ —Å—Ç–∞—Ç—É—Å–µ MERGED, –æ–ø–µ—Ä–∞—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –æ—à–∏–±–∫–∏.

**–§–∞–π–ª:** `internal/service/pullrequest_service_impl.go`


### 3. –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∏–∑–æ–ª—è—Ü–∏—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤?

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `testcontainers-go` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ PostgreSQL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞.

**–§–∞–π–ª:** `test/integration/setup.go`

### 4. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–æ–∫–æ–≤

**–í–æ–ø—Ä–æ—Å:** –ì–¥–µ —Ä–∞–∑–º–µ—â–∞—Ç—å –º–æ–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤?

**–†–µ—à–µ–Ω–∏–µ:** –ú–æ–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç `internal/mocks/` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–∞—Ö

**–§–∞–π–ª:** `internal/mocks/mocks.go`

### 6. –ü–µ—Ä–µ–¥–∞—á–∞ ID PR –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤ –ë–î –ø–æ–ª–µ `id` —Ç–∞–±–ª–∏—Ü—ã `pull_requests` –±—ã–ª–æ —Ç–∏–ø–∞ `SERIAL`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é ID —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è–ª–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–≤–æ–π ID –≤ body –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PR.

**–†–µ—à–µ–Ω–∏–µ:** 
1. –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø –ø–æ–ª—è `id` —Å `SERIAL` –Ω–∞ `INTEGER PRIMARY KEY`


## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –ë–î –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:
  - `idx_users_team_active` ‚Äî –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–º–∞–Ω–¥—ã
  - `idx_pr_reviewers_pr_id` ‚Äî –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤ PR
  - `idx_pr_reviewers_reviewer_id` ‚Äî –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ PR –ø–æ —Ä–µ–≤—å—é–≤–µ—Ä—É


